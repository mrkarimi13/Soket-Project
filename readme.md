SecuriChat - پروژه شبکه‌های کامپیوتری
این پروژه یک پیام‌رسان امن به نام SecuriChat است که برای درس شبکه‌های کامپیوتری طراحی شده. هدف اصلی، پیاده‌سازی یک برنامه چت با استفاده از مفاهیم شبکه مثل TCP، P2P و رمزنگاری چندلایه (Onion Routing) برای بالا بردن امنیت و حریم خصوصی کاربران است.
مراحل پیاده‌سازی
روند کلی ساخت این برنامه به چند مرحله اصلی تقسیم شد.
اول از همه، بخش مرکزی سیستم یعنی Tracker ساخته شد. کار Tracker این است که مثل یک دفترچه تلفن عمل کند و لیست کاربران آنلاین را نگه دارد. هر کاربری که وارد برنامه می‌شود، خودش را به Tracker معرفی می‌کند و Tracker هم آدرس IP و پورت او را ذخیره می‌کند.
بعد از اون، کلاینت پایه طراحی شد. در این مرحله، کلاینت یاد گرفت که چطور به Tracker وصل شود، خودش را ثبت کند و لیست بقیه کاربران آنلاین را از Tracker بگیرد. ارتباط بین کلاینت و Tracker با پروتکل TCP انجام شد تا مطمئن باشیم اطلاعات درست رد و بدل می‌شود.
مرحله بعدی، برقراری ارتباط مستقیم بین دو کلاینت یا همان P2P بود. وقتی یک کلاینت لیست کاربران را از Tracker می‌گرفت، می‌توانست با استفاده از IP و پورت بقیه، یک ارتباط مستقیم TCP با آن‌ها برقرار کند. این زیرساخت اصلی برای ارسال پیام بود.
مهم‌ترین و پیچیده‌ترین بخش، پیاده‌سازی Onion Routing بود. برای ارسال یک پیام از کاربر A به کاربر B، کاربر A یک کاربر سوم (مثلاً C) را به عنوان واسطه انتخاب می‌کرد. بعد پیام را اول برای B رمزنگاری می‌کرد، و نتیجه را دوباره برای C رمزنگاری می‌کرد. وقتی C بسته را می‌گرفت، فقط می‌توانست لایه رویی را باز کند و می‌فهمید که باید باقی بسته را به B بفرستد. به این ترتیب، C هیچ‌وقت از محتوای اصلی پیام خبردار نمی‌شد. برای این کار از ترکیب رمزنگاری نامتقارن (RSA) برای تبادل کلیدهای یک‌بار مصرف و رمزنگاری متقارن (Fernet) برای خود پیام استفاده شد.
برای اطمینان از اینکه داده‌ها در طول مسیر خراب نمی‌شوند، یک Checksum با الگوریتم SHA-256 برای هر پیام ساخته شد. گیرنده نهایی پیام، بعد از باز کردن تمام لایه‌های رمزنگاری، این Checksum را دوباره محاسبه و با مقدار ارسال شده مقایسه می‌کرد.
در کنار این‌ها، قابلیت ارسال فایل و تماس صوتی هم اضافه شد. ارسال فایل با تقسیم کردن فایل به قطعات کوچک (chunks) و فرستادن آن‌ها روی همان بستر امن Onion Routing انجام شد. اما برای تماس صوتی که به سرعت بالا و تأخیر کم نیاز دارد، از پروتکل UDP استفاده شد. اطلاعات مربوط به برقراری تماس (مثل درخواست و پذیرش) از طریق مسیر امن TCP فرستاده می‌شد، اما خود داده‌های صوتی به صورت مستقیم با UDP بین دو کاربر رد و بدل می‌شد.
در نهایت، یک رابط کاربری ساده با کتابخانه CustomTkinter ساخته شد تا کار با برنامه راحت‌تر باشد و تمام رویدادهای مهم هم در فایل report.log ثبت شدند تا بررسی و اشکال‌زدایی برنامه ساده‌تر شود.
پیش‌نیازها
برای اجرای این برنامه به پایتون 3 و چند کتابخانه نیاز دارید. بهتر است آن‌ها را داخل یک محیط مجازی (virtual environment) نصب کنید.
pip install -r requirements.txt
محتوای فایل requirements.txt باید شامل موارد زیر باشد:
customtkinter
cryptography
pyaudio
نکته مهم: نصب pyaudio ممکن است روی بعضی سیستم‌عامل‌ها کمی سخت باشد. اگر به مشکل خوردید، می‌توانید با جستجو در اینترنت راهنمای نصب مخصوص سیستم‌عامل خودتان را پیدا کنید. برای ویندوز معمولاً دستور زیر کار می‌کند:
pip install pipwin
pipwin install pyaudio
نحوه اجرای برنامه
اجرای برنامه شامل دو مرحله است: اول باید سرور ردیاب (Tracker) را اجرا کنید و بعد کلاینت‌ها را.
۱. اجرای Tracker
Tracker لیست کاربران آنلاین و اطلاعات اتصال آن‌ها را نگهداری می‌کند. برای اجرای آن، ترمینال را باز کرده و دستور زیر را وارد کنید:
python tracker.py
بعد از اجرای این دستور، سرور روی آدرس 127.0.0.1 و پورت 8000 شروع به کار می‌کند و منتظر اتصال کلاینت‌ها می‌ماند.
۲. اجرای کلاینت‌ها
برای اینکه بتوانید چت کنید، باید حداقل دو کلاینت (یا بیشتر) را اجرا کنید. برای هر کاربر، یک ترمینال جداگانه باز کنید و دستور زیر را اجرا کنید:
python client.py
با اجرای این دستور، یک پنجره گرافیکی باز می‌شود که از شما نام کاربری و آدرس Tracker را می‌پرسد. نام کاربری دلخواه خود را وارد کنید و اگر Tracker روی همین سیستم اجرا شده، آدرس پیش‌فرض 127.0.0.1:8000 صحیح است.
نکته: برای تست کامل قابلیت Onion Routing، باید حداقل سه کلاینت را همزمان اجرا کنید تا همیشه یک کاربر سوم به عنوان واسطه (relay) برای ارسال پیام وجود داشته باشد.
اجرای تست‌های خودکار
برای اطمینان از صحت عملکرد بخش‌های مختلف برنامه، مثل ماژول رمزنگاری و ارتباطات شبکه، چند تست خودکار نوشته شده است. برای اجرای این تست‌ها از دستور زیر استفاده کنید:
python -m unittest test_securichat.py
این دستور تمام تست‌ها را اجرا کرده و نتیجه را در ترمینال نمایش می‌دهد.